NIP-69
======

Labeling, and a Defined Vocabulary for Content Moderation
---------------------------------------------------------

`draft` `optional` `author:s3x-jay` `author:rabble`

### Purpose

To provide a standardized way for content to be labeled both when it is published (by the author) or after the fact (by third parties or the original author), and to specify a defined vocabulary for content moderation.

## Labeling System

The labeling system defined here accommodates structured labeling from _any_ defined vocabulary, as well as free form unstructured labeling. 

### Structured labels

Structured labels are made up of two parts:
- The code indicating which defined vocabulary is being used (referred to as `vocab` below)
- The code from the defined vocabulary (referred to as `code` below)

Both `vocab` and `code` must be short ASCII strings with no spaces. If the common name of a vocabulary has a space in it (e.g. ISO 3166-2) it shall be the convention to replace the space with a dash.

The value of the structured label would be "`vocab`>`code`"

Two `vocab` values are reserved:
- MOD (for the moderation vocabulary defined below)
- X-MOD (for experiments in moderation and moderating regional issues, discussed below)
- \# (for adding hashtags)

_Examples:_
- "MeSH>D005528" would add the label ["Foot"](https://meshb.nlm.nih.gov/record/ui?ui=D005528) from NIH's Medical Subject Headings vocabulary
- "#>footster" would allow fans of Footster to add the hashtag #footster to someone's post
- "GeoNames>3173435" would add a label specifying [Milan, Italy](https://www.geonames.org/3173435/milan.html) using the GeoNames coding system
- "ISO-3166-2>IT-MI" would add a label specifying Milano, Italy using ISO 3166-2.

#### Proprietary structured vocabularies

Organizations may label events with their own proprietary coding systems. They should use care selecting their unique `vocab` value to ensure it doesn't confict with values used by others or the values for well-known defined vocabularies. Organizations who publish events with proprietary vocabularies are encouraged to publish those vocabularies to Nostr so they can be used by others. The process for publishing the vocabulary will be defined in a subsequent NIP.

Repeated, intentional use of `vocab` values that conflict with the common names of well-known defined vocabularies will be considered spam.

#### Accomodating bots & advanced users

It is expected that bots will, in time, contribute to the labeling process, as will advanced users (e.g. scientists, moderators). These groups will require additional relevant information not required by regular users. Some of the concepts they will need supported are:

- `quality` is a real number between 0 and 1 which expresses how good of an example the item being labeled is of that label.
- `degree` is a real number between 0 and 1 which expresses where the item falls on a range if the label refers to a range. 
- `confidence` is a real number between 0 and 1 which expresses how certain the entity publishing the label is that the label is accurate. It will mostly be used by bots.
- `support` is an array of URLs and/or Nostr ids with information to support the labeling.  

The concepts above are optional. It is not expected that client apps aimed at regular users will make use of these concepts.

### Unstructured labels

While defined vocabularies may be used heavily by automated systems, regular users need the ability to add free form labels. Unstructured labels are handled separately, as discussed below.

_Example:_ 
- "Sandals from Milan"

### Labeling when a note is published

Any event of _any kind_ may include labels relevant to its `content`. It shall do this using the following tags:
- `l` for structured labels
- `label` for unstructured labels

Clients MUST use one `l` tag for each structured label (which may result in multiple `l` tags). However there may only be one `label` tag. A value of "#" for `vocab` SHOULD NOT be used when content is originally being published as it would be redundant with the `t` tag.

`l` and `label` tags may be extended using an optional, JSON-encoded parameter.

_Example:_ 

```json
{
    "pubkey": "<pub-key>",
    "created_at": 1000000000,
    "kind": 1,
    "tags": [
      ["t", "Footster"],
      ["l", "MeSH>D005528"],
      ["l", "GeoNames>3173435", "{\"confidence\":1,\"quality\":1}"],
      ["l", "ISO-3166-2>IT-MI", "{\"confidence\":1,\"quality\":1}"],
      ["label", "Sandals from Milan", "{\"confidence\":1,\"quality\":0.9}"] 
    ],
    "content": "Look at the great sandals I picked up in Milan! I love how my feet look in them… https://domain.com/image.jpg",
    "id": "<event-id>"
}
```

### Labeling an event after initial publication

Labeling after initial publication will use ([parameterized replaceable](https://github.com/nostr-protocol/nips/blob/master/33.md)) kind 32123. 

`content` is optional for kind 32123. If included it should be a summary of the labeling. It should not reference 

<Confirmation is needed that what is spec'd below properly conforms to NIP-33.>

_Examples:_ 

A fan of Footster sees a post they really like that they think should get the tag #footster…
```json
{
  "kind": 32123,
  "pubkey": "labeler",
  "tags": [
    ["d", "labels-<eventid>"],
    ["e", "<eventid of event being labeled>"],
    ["p", "<pubkey of event being labeled>"],
    ["l", "#>footster", "{\"confidence\":1,\"quality\":0.8}"]
  ],
  "content": "Lovely feet!"
}
```
A scientist comes across a post on Ebola and they want to label it to make it easier for others to find…
```json
{
  "kind": 32123,
  "pubkey": "labeler",
  "tags": [
    ["d", "labels-<eventid>"],
    ["e", "<eventid of event being labeled>"],
    ["p", "<pubkey of event being labeled>"],
    ["l", "MeSH>D019142", "{\"confidence\":1,\"quality\":0.8}"],
    ["l", "GeoNames>203312", "{\"confidence\":1,\"support\":[\"https://www.cdc.gov/vhf/ebola/history/chronology.html\"]}"]
  ],
  "content": "Post discusses paper on the origins of Ebola."
}
```
If a profile is being labeled the labeling event would be similar, but slightly different…

```json
{
  "kind": 32123,
  "pubkey": "labeler",
  "tags": [
    ["d", "labels-<pubkey being labeled>"],
    ["p", "<pubkey being labeled>"],
    ["l", "MeSH>D019142", "{\"confidence\":1,\"quality\":0.9}"],
    ["l", "GeoNames>660013", "{\"confidence\":1}"]
  ],
  "content": "Dr. Korhonen is a Finnish scientist who is one of the world's leading experts on Ebola."
}
```

## Defined Vocabularies for Content Moderation

Just as MeSH helps scientists and medical professionals communicate effectively and find articles on a particular topic quickly, people (and automated agents) performing content moderation tasks on Nostr need a defined vocabulary to communicate effectively and find and act on particular types of moderation reports quickly. 

While __content moderation is completely optional on Nostr__, this vocabulary is needed because many relay owners feel the need to stay compliant with their local laws as well as the standards and preferences of the communities they serve. Additionally, client apps need to cater to the preferences of their users and sometimes to the standards imposed by the app stores they're listed in. 

The fact that something is in a moderation vocabulary says nothing about the ethical or moral quality of that type of content. Ethical and moral standards vary widely around the world.

### The "MOD" vocabulary

This vocabulary only defines things believed to affect the most number of Nostr users. By design it is not a full, comprehensive list of every possible moderation category. More specialized or regional issues are handled by the `X-MOD` vocabulary, discussed below.

There is no requirement for anyone to use the entire vocabulary or even most of it. Different parts of the vocabulary are relevant in some contexts but not in others. Clients apps and moderators should only use the portion of the vocabulary that applies to their particular situation. Some may ignore moderation issues completely (support for this NIP is optional and support for the full `MOD` vocabulary is not required to claim an app supports this NIP).

Client apps which support content reporting should not overwhelm users with too many choices. Sub-categories should only be displayed after the user chooses the general category. Client apps are further encouraged to make use of geolocation data, if available, to hide categories/sub-categories that are not relevant in the user's country or region.

#### Reportable Types

**_Format:_ AB-cde**
- where 'AB' is a mandatory 2 character, uppercase code of a major content type category
- and 'cde' is an optional 3 character, lowercase code representing a sub-category

TypeCode | Type | Public Notes | Development Notes
--- | --- | --- | ---
CL |  Coarse Language / Profanity | |
HC-fin | Promotion of content that is likely to cause financial ruin | consider also Fraud & Scams |
HC-bhd | Promotion of content that is likely to cause serious bodily harm or death | |
IH | Intolerance & Hate | does not include intolerance of intolerance | |
IL | Illegal Content | post/profile is illegal or advocates illegal activity |
IL-cop | Copyright violation, piracy, intellectual property theft | |
IL-csa | Child sexual abuse and/or trafficking | |
IL-drg | Drug-related crime | |
IL-frd | Fraud & Scams | |
IL-har | Harassment / stalking / doxxing | |
IL-hkr | Prostitution | | relevant countries: https://en.wikipedia.org/wiki/Prostitution_by_region
IL-idt | Impersonation / identity theft / phishing | | the npub or nprofile of the victim should be passed using `support`
IL-mal | Malware / viruses / ransomware | |
NS | Nudity & Sex | for use when there is no intention to arouse |
NS-nud | Casual nudity | |
NS-ero | Erotica | |
NS-sex | Sex | |
PG | No Sensitive Content | for use in situations where sensitive content might be assumed |
PN | Pornography | for use when there is an intention to sexually arouse |
PN-het | Heterosexual porn | |
PN-gay | Gay male porn | | relevant countries: https://en.wikipedia.org/wiki/LGBT_rights_by_country_or_territory
PN-les | Lesbian porn | |
PN-bis | Bisexual porn | |
PN-trn | Transsexual porn | |
PN-fnb | Gender-fluid / non-binary porn | |
SP | Spam | |
SP-mod | Moderation report spam | |
VI | Violence | actual or advocated | |
VI-hum | Violence towards a human being | |
VI-ani | Violence towards a sentient animal | |

#### Contexts

Contexts are situations where otherwise objectionable content might be allowed.

**_Format:_ AB**
- where 'AB' is a mandatory 2 character, uppercase code of a major content type category

ContextCode | Context
--- | ---
ED | Educational
FA | Fine Art
FF | Fantasy / Fiction
MS | Medical / Scientific
ND | News & Documentaries
PP | Political Protest

### The X-MOD vocabulary

The MOD vocabulary does not cover all cases where content will need to be moderated - only the cases that are likely to affect the largest number of Nostr users. The X-MOD vocabulary will fill the gap of other cases that could use something better than an unstructured freeform text field.

The X-MOD vocabulary is intended to be organic. People and entities doing content moderation can implement terms as they see fit - in coordinaton with others who will use their terms. It is a good way to test the use of new terms before including those terms in the MOD vocabulary. It will also be useful for regional moderation issues that may never have enough use to be included in MOD.

The TypeCodes/ContextCodes for X-MOD do not need to follow the same structure as the MOD vocabulary unless the intent is for the code to eventually be integrated into the MOD vocabulary. In that case the format should be "AB-cde" as it is in the MOD vocabulary.

### Content moderation using labels

Content moderation will be accomplished via a mix of self-labeling (by responsible users), and 3rd party labeling after the fact. 

__This NIP deprecates both NIP-36 and NIP-56__

- NIP-36 is deprecated because labeling uses the more general `l` and `label` tags rather than the use-specific, unstructured `content-warning` tag.
- NIP-56 is deprecated because replaceable events are required for labeling and kind 1984 is not replaceable.

#### Self-labeling

- Users with content that is likely to be considered "sensitive" can label their content with at the time it is published by including `l` and `label` tags in their event at the time of publishing. 
- Users can label their profile page as sensitive.
- User

```
tag: content-warning
options:
 - [reason]: may be a null or blank
 - [codes]: mandatory
```
The [reason] option was defined in NIP-36. It may be null or a blank string.

An additional mandatory option is added to the content-warning tag - [codes] - which contains a comma delimited list of relevant content type and context codes.

##### Content warnings for particular components of a profile

If NIP-36 is being used to self-report one's profile the user may classify the entire profile and/or just parts of a profile by appending the item name for the applicable part of the profile to the content type or context code. For example:

- AB-cde (would apply to the entire profile)
- AB-cde-picture (would apply to the user's avatar only)
- AB-cde-website (would apply to the link in the user's profile)

Item names used must match items specified in the `content` section of the (Kind 0) event.

### Examples

#### Example 1 - Post with photos from a wet t-shirt contest

Self-reporting the post...
```json
{
    "pubkey": "<pub-key>",
    "created_at": 1000000000,
    "kind": 1,
    "tags": [
      [ "t", "WetTShirt" ],
      [ "l", "MOD>NS-ero" ],
      [ "label", "Wet t-shirt contest" ]
    ],
    "content": "(Racy content goes here)",
    "id": "<event-id>"
}
```
After the fact reporting of same post...
```json
{
  "kind": 1984,
  "tags": [
    [ "e", <eventId>, "MOD>NS-ero" ],
    [ "p", <pubkey> ]
  ],
  "content": "Wet t-shirt contest"
}
```

#### Example 2 - Profile of organization offering life drawing classes

Self-reporting of an entire profile...
```json
{
"id": "<event-id>"
    "pubkey": "<pub-key>",
    "created_at": 1000000000,
    "kind": 0,
    "tags": [
      [ "t", "LifeDrawing" ],
      [ "l", "MOD>NS-nud" ],
      [ "l", "MOD>FA" ]
    ],
    "content": "{\"name\":\"OttawaLifeDrawing\",\"about\":\"Ottawa's newest life drawing classes!\"}"
}
```
After the fact reporting of same profile...
```json
{
  "kind": 1984,
  "tags": [
    [ "p", <pubkey>, "MOD>NS-nud" ],
    [ "p", <pubkey>, "MOD>FA" ]
  ],
  "content": "Lots of drawings of nude people"
}
```

#### Example 3 - Profile of a trans porn star with G-rated avatar and racy header image

Simultaneously self-reporting general theme of profile and particular parts of a profile...
```json
{
"id": "<event-id>"
    "pubkey": "<pub-key>",
    "created_at": 1000000000,
    "kind": 0,
    "tags": [
      [ "t", "TransGirl" ],
      [ "l", "MOD>PN-trn" ],
      [ "l", "MOD>PG-picture" ],
      [ "l", "MOD>PN-trn-website" ],
      [ "l", "MOD>NS-ero-banner" ]
    ],
    "content": "{\"name\":\"PollyPornstar\",\"about\":\"Award-winning trans porn star\",\"banner\":\"https://somesite.com/somepic.jpg\",\"website\":\"https://pornsite.com\",\"picture\":\"https://somesite.com/anotherpic.jpg\"}"
}
```
After the fact reporting of the same profile...
```json
{
  "kind": 1984,
  "tags": [
    [ "p", <pubkey>, "MOD>PN-trn"],
    [ "p", <pubkey>, "MOD>PG-picture"],
    [ "p", <pubkey>, "MOD>PN-trn-website"],
    [ "p", <pubkey>, "MOD>NS-ero-banner"]
  ],
  "content": "Trans porn star with racy banner and website link to a porn site."
}
```

### Future Considerations

#### Translations

The descriptions for each type and context code will need to be translated into other languages to facilitate international use.

#### Future-proofing

It is expected that the content moderation for Nostr will evolve over time and other types of data may be added to the reports. As a result, any additional data after an expected code should be ignored.
